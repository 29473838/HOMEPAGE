<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}ShowkerTMS{% endblock %}</title>
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&family=Nanum+Gothic:wght@400;700&display=swap">

    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
<audio id="bgMusic" autoplay loop>
    <source src="{{ url_for('static', filename='assets/mainmusic.mp3') }}" type="audio/mpeg">
</audio>

<div class="sakura-container" id="sakuraContainer"></div>

<nav>
    <a href="{{ url_for('index') }}">소개</a>
    <a href="{{ url_for('link_page') }}">링크</a>
    <a href="{{ url_for('notice_list') }}">공지글</a>
    <a href="{{ url_for('business_page') }}">비즈니스</a>
    <a href="{{ url_for('contact_page') }}">문의</a>
    <a href="{{ url_for('qna_list') }}">Q&A</a>

    <span class="nav-stream">
        <a href="{{ url_for('stream_page') }}">방송 정보</a>
        <span class="nav-stream-status">
            {% if current_stream %}
                {% if current_stream.status == "방송중" and current_stream.platform %}
                    {% if current_stream.url %}
                        <a href="{{ current_stream.url }}" target="_blank" class="nav-stream-live">
                            ● LIVE ({{ current_stream.platform }})
                        </a>
                    {% else %}
                        <span class="nav-stream-live">
                            ● LIVE ({{ current_stream.platform }})
                        </span>
                    {% endif %}
                {% else %}
                    <span class="nav-stream-text">
                        상태: {{ current_stream.status }}
                    </span>
                {% endif %}
            {% else %}
                <span class="nav-stream-text">
                    상태: 오프라인
                </span>
            {% endif %}
        </span>
    </span>

    {% if current_user.is_authenticated %}
        <a href="{{ url_for('profile') }}">프로필</a>
        {% if has_permission(current_user, 'warning_manage') or has_permission(current_user, 'promote') %}
            <a href="{{ url_for('dashboard') }}">대시보드</a>
        {% endif %}
        <a href="{{ url_for('logout') }}">로그아웃</a>
    {% else %}
        <a href="{{ url_for('login') }}">로그인</a>
        <a href="{{ url_for('register') }}">회원가입</a>
    {% endif %}
</nav>

<main>
    <div class="page-container">
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, msg in messages %}
                <div class="flash flash-{{ category }}">{{ msg }}</div>
            {% endfor %}
        {% endif %}
        {% endwith %}

        {% block content %}{% endblock %}
    </div>
</main>

<footer class="site-footer">
    <div class="site-footer-inner">
        <span>© {{ current_year }} ShowkerTMS. All rights reserved.</span>
        <span class="footer-links">
            <a href="{{ url_for('privacy') }}">개인정보처리방침</a>
            <span class="footer-sep">|</span>
            <a href="{{ url_for('oss_licenses') }}">오픈소스 라이선스</a>
        </span>
    </div>
</footer>

<script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>

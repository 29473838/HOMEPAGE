{% extends "base.html" %}
{% block title %}공지 작성 - 소리가 담긴 타임머신{% endblock %}

{% block content %}
<div class="notice-page-wrapper">
    <h1 class="page-title">새 공지 작성</h1>

    <div class="card">
        <form method="POST" enctype="multipart/form-data" id="notice-write-form">
            <label>공지 분류</label>
            <select name="category" required>
                <option value="일반공지">일반공지</option>
                <option value="방송공지">방송공지</option>
                <option value="패치노트">패치노트</option>
            </select>

            <label>제목</label>
            <input type="text" name="title" placeholder="제목" required>

            <label>내용</label>
            {# Toast UI Editor 가 올라갈 영역 #}
            <div id="notice-editor"></div>

            {# 이 hidden textarea 에 최종 HTML 내용이 들어가서 서버로 전송됨 #}
            <textarea id="notice-content" name="content" style="display:none;"></textarea>

            <label style="margin-top:10px;">이미지 첨부 (선택)</label>
            <input type="file" name="image" accept="image/*">

            <button type="submit" class="btn" style="margin-top:12px;">등록</button>
        </form>
    </div>
</div>

{# Toast UI Editor CDN #}
<link rel="stylesheet"
      href="https://uicdn.toast.com/editor/latest/toastui-editor.min.css">
<script src="https://uicdn.toast.com/editor/latest/toastui-editor-all.min.js"></script>

<script>
    const hiddenInput = document.getElementById('notice-content');

    const editor = new toastui.Editor({
        el: document.querySelector('#notice-editor'),
        height: '500px',
        initialEditType: 'wysiwyg',  
        previewStyle: 'vertical',
        initialValue: hiddenInput.value || '',
    });

    document.getElementById('notice-write-form').addEventListener('submit', function (e) {
        hiddenInput.value = editor.getHTML();
    });
</script>
{% endblock %}

